{"version":3,"file":"comment-plugin.esm.js","sources":["../src/draggable.js","../src/comment.js","../src/utils.js","../src/frame-comment.js","../src/inline-comment.js","../src/manager.js","../src/index.js"],"sourcesContent":["export default class Draggable {\r\n\r\n    constructor(el, onStart = () => {}, onTranslate = () => {}, onDrag = () => {}) {\r\n        this.mouseStart = null;\r\n\r\n        this.el = el;\r\n        this.onStart = onStart;\r\n        this.onTranslate = onTranslate;\r\n        this.onDrag = onDrag;\r\n\r\n        this.initEvents(el);\r\n    }\r\n\r\n    initEvents(el) {\r\n        el.addEventListener('pointerdown', this.down.bind(this));\r\n\r\n        const windowListenGuard = (type, listener) => {\r\n            window.addEventListener(type, listener);\r\n            return () => window.removeEventListener(type, listener);\r\n        };\r\n\r\n        this.onDestroy = [\r\n            windowListenGuard('pointermove', this.move.bind(this)),\r\n            windowListenGuard('pointerup', this.up.bind(this))\r\n        ];\r\n    }\r\n\r\n    getCoords(e) {\r\n        const props = e.touches ? e.touches[0] : e;\r\n\r\n        return [props.pageX, props.pageY];\r\n    }\r\n\r\n    down(e) {\r\n        e.stopPropagation();\r\n        this.mouseStart = this.getCoords(e);\r\n\r\n        this.onStart();\r\n    }\r\n\r\n    move(e) {\r\n        if (!this.mouseStart) return;\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        let [x, y] = this.getCoords(e);\r\n        let delta = [x - this.mouseStart[0], y - this.mouseStart[1]];\r\n        let zoom = this.el.getBoundingClientRect().width / this.el.offsetWidth;\r\n\r\n        this.onTranslate(delta[0] / zoom, delta[1] / zoom);\r\n    }\r\n\r\n    up() {\r\n        if (this.mouseStart) {\r\n            this.onDrag();\r\n        }\r\n\r\n        this.mouseStart = null;\r\n    }\r\n\r\n    destroy() {\r\n        this.onDestroy.forEach(cb => cb());\r\n    }\r\n}","import Draggable from './draggable';\r\n\r\nexport default class Comment {\r\n    constructor(text, editor) {\r\n        this.editor = editor;\r\n        this.text = text;\r\n        this.scale = 1;\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.dragPosition = [0, 0];\r\n        this.links = [];\r\n \r\n        this.initView();\r\n        this.update();\r\n    }\r\n\r\n    initView() {\r\n        this.el = document.createElement('div');\r\n        this.el.tabIndex = 1;\r\n        this.el.addEventListener('contextmenu', this.onContextMenu.bind(this));\r\n        this.el.addEventListener('focus', this.onFocus.bind(this));\r\n        this.el.addEventListener('blur', this.onBlur.bind(this));\r\n    \r\n        this.draggable = new Draggable(\r\n            this.el, () => this.onStart(), (dx, dy) => this.onTranslate(dx, dy));\r\n    }\r\n\r\n    linkTo(ids) {\r\n        this.links = ids || [];\r\n    }\r\n\r\n    linkedTo(node) {\r\n        return this.links.includes(node.id);\r\n    }\r\n\r\n    k() {\r\n        return 1;\r\n    }\r\n\r\n    onContextMenu(e) {\r\n        e.preventDefault();\r\n        e.stopPropagation();\r\n\r\n        this.editor.trigger('editcomment', this);\r\n    }\r\n\r\n    onFocus() {\r\n        this.scale = Math.max(1, 1 / this.k());\r\n        this.update();\r\n        this.editor.trigger('commentselected', this)\r\n    }\r\n\r\n    focused() {\r\n        return document.activeElement === this.el;\r\n    }\r\n\r\n    onBlur() {\r\n        this.scale = 1;\r\n        this.update()\r\n    }\r\n\r\n    blur() {\r\n        this.el.blur();\r\n    }\r\n\r\n    onStart() {\r\n        this.dragPosition = [this.x, this.y];\r\n    }\r\n\r\n    onTranslate (dx, dy) {\r\n        const [x, y] = this.dragPosition;\r\n\r\n        this.x = x + this.scale * dx;\r\n        this.y = y + this.scale * dy;\r\n        \r\n        this.update();\r\n    }\r\n\r\n    update() {\r\n        this.el.innerText = this.text;\r\n        this.el.style.transform = `translate(${this.x}px, ${this.y}px) scale(${this.scale})`;\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            text: this.text,\r\n            position: [ this.x, this.y ],\r\n            links: this.links\r\n        }\r\n    }\r\n\r\n    destroy() {\r\n        this.draggable.destroy();\r\n    }\r\n}","const min = (arr) => arr.length === 0 ? 0 : Math.min(...arr);\r\nconst max = (arr) => arr.length === 0 ? 0 : Math.max(...arr);\r\n\r\nexport function intersectRect(r1, r2) {\r\n    return !(\r\n        r2.left > r1.right || \r\n        r2.right < r1.left || \r\n        r2.top > r1.bottom ||\r\n        r2.bottom < r1.top\r\n    );\r\n}\r\n\r\nexport function containsRect(r1, r2) {\r\n    return (\r\n        r2.left > r1.left && \r\n        r2.right < r1.right && \r\n        r2.top > r1.top &&\r\n        r2.bottom < r1.bottom\r\n    );\r\n}\r\n\r\nexport function nodesBBox(editor, nodes, margin) {\r\n    const left = min(nodes.map(node => node.position[0])) - margin;\r\n    const top = min(nodes.map(node => node.position[1])) - margin;\r\n    const right = max(nodes.map(node => node.position[0] + editor.view.nodes.get(node).el.clientWidth)) + 2 * margin;\r\n    const bottom = max(nodes.map(node => node.position[1] + editor.view.nodes.get(node).el.clientHeight)) + 2 * margin;\r\n    \r\n    return {\r\n        left,\r\n        right,\r\n        top,\r\n        bottom,\r\n        width: Math.abs(left - right),\r\n        height: Math.abs(top - bottom),\r\n        getCenter: () => {\r\n            return [\r\n                (left + right) / 2,\r\n                (top + bottom) / 2\r\n            ];\r\n        }\r\n    };\r\n}","import Comment from './comment';\r\nimport { containsRect } from './utils';\r\n\r\nexport default class FrameComment extends Comment {\r\n    constructor(text, editor) {\r\n        super(text, editor);\r\n        \r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.links = [];\r\n        this.el.className = 'frame-comment';\r\n    }\r\n\r\n    linkedNodesView() {\r\n        return this.links\r\n            .map(id => this.editor.nodes.find(n => n.id === id))\r\n            .map(node => this.editor.view.nodes.get(node));\r\n    }\r\n\r\n    onStart() {\r\n        super.onStart();\r\n        this.linkedNodesView().map(nodeView => nodeView.onStart())\r\n    }\r\n\r\n    onTranslate(dx, dy) {\r\n        super.onTranslate(dx, dy);\r\n        this.linkedNodesView().map(nodeView => nodeView.onDrag(dx, dy))\r\n    }\r\n\r\n    isContains(node) {\r\n        const commRect = this.el.getBoundingClientRect();\r\n        const view = this.editor.view.nodes.get(node);\r\n    \r\n        return containsRect(commRect, view.el.getBoundingClientRect());\r\n    }\r\n\r\n    update() {\r\n        super.update();\r\n\r\n        this.el.style.width = this.width+'px';\r\n        this.el.style.height = this.height+'px';\r\n    }\r\n\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            type: 'frame',\r\n            width: this.width,\r\n            height: this.height\r\n        }\r\n    }\r\n}","import Comment from './comment';\r\nimport { intersectRect } from './utils';\r\n\r\nexport default class InlineComment extends Comment {\r\n    constructor(text, editor) {\r\n        super(text, editor);\r\n        \r\n        this.el.className = 'inline-comment';\r\n        this.el.addEventListener('mouseup', this.onDrag.bind(this));\r\n    }\r\n\r\n    onDrag() {\r\n        const intersection = this.getIntersectNode();\r\n\r\n        this.linkTo(intersection ? [intersection.node.id] : []);\r\n    }\r\n\r\n    getIntersectNode() {\r\n        const commRect = this.el.getBoundingClientRect();\r\n\r\n        return Array.from(this.editor.view.nodes)\r\n            .map(([node, view]) => {\r\n                return { node, rect: view.el.getBoundingClientRect() };\r\n            })\r\n            .find(({ rect }) => {\r\n                return intersectRect(commRect, rect);\r\n            });\r\n    }\r\n\r\n    offset(dx, dy) {\r\n        this.x += dx;\r\n        this.y += dy;\r\n        this.update();\r\n    } \r\n\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            type: 'inline'\r\n        }\r\n    }\r\n}","import FrameComment from './frame-comment';\r\nimport InlineComment from './inline-comment';\r\n\r\nexport default class CommentManager {\r\n    constructor(editor) {\r\n        this.editor = editor;\r\n        this.comments = [];\r\n\r\n        editor.on('zoomed', () => {\r\n            this.comments.map(c => c.blur.call(c));\r\n        });\r\n    }\r\n\r\n    addInlineComment(text, [ x, y ], links = []) {\r\n        let comment = new InlineComment(text, this.editor);\r\n\r\n        comment.k = () => this.editor.view.area.transform.k;\r\n        comment.x = x;\r\n        comment.y = y;\r\n        comment.linkTo(links);\r\n\r\n        this.addComment(comment);\r\n    }\r\n\r\n    addFrameComment(text, [ x, y ], links = [], width = 0, height = 0) {\r\n        let comment = new FrameComment(text, this.editor);\r\n\r\n        comment.x = x;\r\n        comment.y = y;\r\n        comment.width = width;\r\n        comment.height = height;\r\n        comment.linkTo(links);\r\n        \r\n        this.addComment(comment);\r\n    }\r\n\r\n    addComment(comment) {\r\n        comment.update();\r\n        this.comments.push(comment);\r\n\r\n        this.editor.view.area.appendChild(comment.el);\r\n        this.editor.trigger('commentcreated', comment);\r\n    }\r\n\r\n    deleteComment(comment) {\r\n        this.editor.view.area.removeChild(comment.el);\r\n        this.comments.splice(this.comments.indexOf(comment), 1);\r\n        comment.destroy();\r\n\r\n        this.editor.trigger('commentremoved', comment);\r\n    }\r\n\r\n    deleteFocusedComment() {\r\n        const focused = this.comments.find(c => c.focused());\r\n        \r\n        if (focused)\r\n            this.deleteComment(focused)\r\n    }\r\n\r\n    deleteComments() {\r\n        [...this.comments].map(c => this.deleteComment(c));\r\n    }\r\n\r\n    toJSON() {\r\n        return this.comments.map(c => c.toJSON())\r\n    }\r\n\r\n    fromJSON(list) {\r\n        this.deleteComments();\r\n        list.map(item => {\r\n            if (item.type === 'frame') {\r\n                this.addFrameComment(item.text, item.position, item.links, item.width, item.height)\r\n            } else {\r\n                this.addInlineComment(item.text, item.position, item.links);\r\n            }\r\n        });\r\n    }\r\n\r\n    destroy() {\r\n        this.comments.forEach(comment => comment.destroy());\r\n    }\r\n}","import './style.sass';\r\nimport CommentManager from './manager';\r\nimport FrameComment from './frame-comment';\r\nimport InlineComment from './inline-comment';\r\nimport { nodesBBox } from './utils';\r\n\r\n// eslint-disable-next-line max-statements\r\nfunction install(editor, { margin = 30, disableBuiltInEdit = false }) {\r\n    editor.bind('commentselected');\r\n    editor.bind('commentcreated');\r\n    editor.bind('commentremoved');\r\n    editor.bind('syncframes');\r\n    editor.bind('addcomment');\r\n    editor.bind('removecomment');\r\n    editor.bind('editcomment');\r\n\r\n    const manager = new CommentManager(editor);\r\n\r\n    if (!disableBuiltInEdit) { \r\n        editor.on('editcomment', (comment) => {\r\n            comment.text = prompt('Edit comment', comment.text)\r\n            comment.update();\r\n        });\r\n    }\r\n\r\n    function handleKey(e) {\r\n        if (e.code === 'KeyF' && e.shiftKey) {\r\n            const ids = editor.selected.list.map(node => node.id);\r\n            const nodes = ids.map(id => editor.nodes.find(n => n.id === id));\r\n    \r\n            editor.trigger('addcomment', ({ type: 'frame', nodes }))\r\n        } else if (e.code === 'KeyC' && e.shiftKey) {\r\n            const position = Object.values(editor.view.area.mouse);\r\n\r\n            editor.trigger('addcomment', ({ type: 'inline', position }))\r\n        } else if (e.code === 'Delete') {\r\n            manager.deleteFocusedComment();\r\n        }\r\n    }\r\n\r\n    editor.on('keydown', handleKey)\r\n\r\n    editor.on('addcomment', ({ type, text, nodes, position }) => {\r\n        if (type === 'inline') {\r\n            manager.addInlineComment(text, position);\r\n        } else if (type === 'frame') {\r\n            const { left, top, width, height } = nodesBBox(editor, nodes, margin);\r\n            const ids = nodes.map(n => n.id);\r\n        \r\n            manager.addFrameComment(text, position || [ left, top ], ids, width, height);\r\n        } else {\r\n            throw new Error(`type '${type}' not supported`);\r\n        }\r\n    })\r\n\r\n    editor.on('removecomment', ({ comment, type }) => {\r\n        if (comment) {\r\n            manager.deleteComment(comment)\r\n        } else if (type === 'inline') {\r\n            manager.comments\r\n                .filter(c => c instanceof InlineComment)\r\n                .map(c => manager.deleteComment(c))\r\n        } else if (type === 'frame') {\r\n            manager.comments\r\n                .filter(c => c instanceof FrameComment)\r\n                .map(c => manager.deleteComment(c))\r\n        }\r\n    });\r\n\r\n    editor.on('syncframes', () => {\r\n        manager.comments\r\n            .filter(comment => comment instanceof FrameComment)\r\n            .map(comment => {\r\n                const nodes = comment.links.map(id => editor.nodes.find(n => n.id === id));\r\n                const { left, top, width, height } = nodesBBox(editor, nodes, margin);\r\n\r\n                comment.x = left;\r\n                comment.y = top;\r\n                comment.width = width;\r\n                comment.height = height;\r\n                \r\n                comment.update()\r\n            });\r\n    })\r\n\r\n    editor.on('nodetranslated', ({ node, prev }) => {\r\n        const dx = node.position[0] - prev[0];\r\n        const dy = node.position[1] - prev[1];\r\n\r\n        manager.comments\r\n            .filter(comment => comment instanceof InlineComment)\r\n            .filter(comment => comment.linkedTo(node))\r\n            .map(comment => comment.offset(dx, dy));\r\n    });\r\n\r\n    editor.on('nodedraged', node => {\r\n        manager.comments\r\n            .filter(comment => comment instanceof FrameComment)\r\n            .filter(comment => {\r\n                const contains = comment.isContains(node);\r\n                const links = comment.links.filter(id => id !== node.id);\r\n\r\n                comment.links = contains ? [...links, node.id] : links;\r\n            });\r\n    });\r\n\r\n    editor.on('commentselected', () => {\r\n        const list = [...editor.selected.list];\r\n\r\n        editor.selected.clear();\r\n        list.map(node => node.update ? node.update() : null);\r\n    })\r\n\r\n    editor.on('export', data => {\r\n        data.comments = manager.toJSON();\r\n    });\r\n\r\n    editor.on('import', data => {\r\n        manager.fromJSON(data.comments || []);\r\n    });\r\n\r\n    if (editor.exist('clear')) { // compatibility with previous versions\r\n        editor.on('clear', () => manager.deleteComments())\r\n    }\r\n\r\n    editor.on('destroy', () => manager.destroy());\r\n}\r\n\r\nexport default {\r\n    name: 'comment',\r\n    install\r\n}"],"names":["Draggable","el","onStart","onTranslate","onDrag","mouseStart","initEvents","addEventListener","down","bind","windowListenGuard","type","listener","window","removeEventListener","onDestroy","move","up","e","props","touches","pageX","pageY","stopPropagation","getCoords","preventDefault","x","y","delta","zoom","getBoundingClientRect","width","offsetWidth","forEach","cb","Comment","text","editor","scale","dragPosition","links","initView","update","document","createElement","tabIndex","onContextMenu","onFocus","onBlur","draggable","dx","dy","ids","node","includes","id","trigger","Math","max","k","activeElement","blur","innerText","style","transform","position","destroy","min","arr","length","intersectRect","r1","r2","left","right","top","bottom","containsRect","nodesBBox","nodes","margin","map","view","get","clientWidth","clientHeight","abs","height","getCenter","FrameComment","className","find","n","linkedNodesView","nodeView","commRect","InlineComment","intersection","getIntersectNode","linkTo","Array","from","rect","CommentManager","comments","on","c","call","comment","area","addComment","push","appendChild","removeChild","splice","indexOf","focused","deleteComment","toJSON","list","deleteComments","item","addFrameComment","addInlineComment","install","disableBuiltInEdit","manager","prompt","handleKey","code","shiftKey","selected","Object","values","mouse","deleteFocusedComment","Error","filter","prev","linkedTo","offset","contains","isContains","clear","data","fromJSON","exist","name"],"mappings":"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"}